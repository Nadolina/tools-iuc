  <tool id="parse_mito_blast" name="Parse mitochondrial blast" version="1.0" profile="21.05">
    <description>overlap-conscious coverage calculation between scaffold-accession number pairs from blast output</description>
    <requirements>
        <requirement type="package" version="@TOOL_VERSION">parse_mito_blast</requirement>
        <requirement type="package" version="@TOOL_VERSION@">pandas</requirement>
        <requirement type="package" version="@TOOL_VERSION@">argparse</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
parse_mito_blast 
    --blastout $blastout 
    --covreport
    $output
]]>
``
    </command>
    <inputs>
        <param name="BLAST_RESULTS" label="TSV generated by mito-blast" type="data"/>
        <param name="OUTPUT_FILE_NAME" label="Name to generate for report" type="text"/>
    </inputs>
    <outputs>
        <data name="OUTPUT_FILE" label="${tool.name} on ${on_string}" format="csv"/>
    </outputs>
    <tests>
        <test>
            <param name="BLAST_RESULTS" value="testfiles/bTaeGut2_trio.hap1.partialscaffold266.blast.tsv" />
            <param name="OUTPUT_FILE_NAME" value="testout.csv" />
            <output name="OUTPUT_FILE" file="testout.csv" ftype="csv" />
        </test>
    </tests>
    <help><![CDATA[
	
	This tool is intended for use on the tabular (format 6) output generated by blastn. Depending on filtering choices, blast will output \
	all the alignments it generates. Often there are multiple overlapping alignments for a unique query sequence-accession number pair. This tool \
	collects all alignments between a given pair and calculates the total coverage between the query and accession number, taking into /
	account overlapping alignments. Therefore a user can figure out how much of their query sequence actually identifies with a subject /
	sequence (acc #). This tool was designed for use in the VGP decontamination pipeline - in particular for deciding whether a scaffold /
	(sequence) is of mitochondrial origin. Parse_mito_blast generates a synthesized, tabular report of coverage for scaffolds with >95% /
	identity to a mitochondrial subject sequence. To use, pass a format 6 blast output (--blastout) and the desired name of the report. 

	NOTE: This tool is currently designed for use with the blast headers 'qseqid','sseqid','qlen','length','qcovhsp','eval','qstart','qend','qcovs' /
	and will be sensitive to this order. 

        usage: parse_mito_blast.py [-h] [--blastout "BLASTOUT"] [--covreport "COVREPORT"]

        optional arguments:
        -h, --help            show this help message and exit
        --blastout BLASTOUT   output from submit_mito_blast2.sh; format 6 csv table
                                generated by blasting the assembly against the
                                mitochondrial database
        --covreport COVREPORT
                                name of output report
    ]]>
    </help>
</tool>
